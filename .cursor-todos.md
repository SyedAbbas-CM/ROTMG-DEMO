# TODOs (Cursor)

- [ ] Protocol unification
  - [x] Create `common/protocol.js` and move `BinaryPacket`/`MessageType` there
  - [x] Update server to import from `common/protocol.js`
  - [x] Update client `ClientNetworkManager` to import from `/common/protocol.js`
  - [ ] Remove duplicated protocol definitions from client after verification

- [ ] Shared constants
  - [x] Create `common/constants.js` and move `NETWORK_SETTINGS` there
  - [x] Update server to use `common/constants.js`
  - [ ] Update client to use `/common/constants.js` where appropriate

- [ ] Standardize message shapes
  - [x] Server: wrap `PLAYER_LIST` as `{ players }`
  - [x] Server: send `players` inside `WORLD_UPDATE`
  - [x] Client: expect standardized `{ players }`

- [ ] Entry point cleanup
  - [x] Add `server/index.js` and point package.json to it
  - [ ] Later: fully rename `Server.js` → `server/main.js` and update imports

- [ ] Client boot fix
  - [x] `public/main.js` should call `initGame()` instead of using missing `Game` class

- [ ] Route/module consistency
  - [ ] Convert or remove `src/routes/mapRoutes.js` (CJS) – not used by server

- [ ] Archive/cleanup
  - [ ] Move `public/src/game/backup/` → `archive/client-backups/`
  - [ ] Remove duplicate `ClientBulletManager.js` (keep one referenced by `public/src/managers.js`)
  - [ ] Move root `capabilities/` → `archive/root-capabilities/` (duplicate of `src/capabilities/`)

- [ ] Networking enhancements (next pass)
  - [ ] Enable permessage-deflate on ws server and ensure client supports it
  - [ ] Add `serverTick` on all world updates for reconciliation
  - [ ] Chunk/interest-based broadcast keyed by visible chunks
  - [ ] Coalesce send queues per client

- [ ] LLM Boss isolation
  - [ ] Create `server/world/llm/` and move `BossManager`, `LLMBossController`, `BossSpeechController`
  - [ ] Add README.md describing how to run/extend LLM bosses


